<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.dsc.ufocus.mapper.UserMapper">
  <resultMap id="BaseResultMap" type="cn.dsc.ufocus.entity.UserEntity">
    <!--@mbg.generated-->
    <!--@Table usr-->
    <id column="usr_id" jdbcType="BIGINT" property="id" />
    <result column="chn_nm" jdbcType="VARCHAR" property="chnName" />
    <result column="mbl_phn_nmbr" jdbcType="VARCHAR" property="mobilePhoneNumber" />
    <result column="email_adrs" jdbcType="VARCHAR" property="emailAddress" />
    <result column="is_lck_flg" jdbcType="BIT" property="isLockFlag" />
    <result column="crt_usr_id" jdbcType="BIGINT" property="createUserId" />
    <result column="crt_tm" jdbcType="TIMESTAMP" property="createTime" />
    <result column="latest_update_usr_id" jdbcType="BIGINT" property="latestUpdateUserId" />
    <result column="latest_update_tm" jdbcType="TIMESTAMP" property="latestUpdateTime" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--@mbg.generated-->
    usr_id, chn_nm, mbl_phn_nmbr, email_adrs, is_lck_flg, crt_usr_id, crt_tm, latest_update_usr_id,
    latest_update_tm
  </sql>
  <sql id="Join_Column">
    u.usr_id, u.chn_nm, u.mbl_phn_nmbr, u.email_adrs, u.is_lck_flg, u.crt_usr_id, u.crt_tm, u.latest_update_usr_id,
    u.latest_update_tm
  </sql>

  <select id="selectByEmail" resultMap="BaseResultMap">
    select <include refid="Base_Column_List" />
    from usr where email_adrs = #{emailAddress}
  </select>

  <select id="select" resultMap="BaseResultMap">
    select <include refid="Join_Column" />
    from usr u
    <if test="query.roleId != null">
      inner join usr_role_rel r on u.usr_id = r.usr_id
    </if>
    <where>
      <if test="query.chnName != null and query.chnName != ''">
        and u.chn_nm like concat('%', #{query.chnName}, '%')
      </if>
      <if test="query.mobilePhoneNumber != null and query.mobilePhoneNumber != ''">
        and u.mbl_phn_nmbr like concat('%', #{query.mobilePhoneNumber}, '%')
      </if>
      <if test="query.isLockFlag != null">
        and u.is_lck_flg = #{query.isLockFlag}
      </if>
      <if test="query.roleId != null">
        and r.role_id = #{query.roleId}
      </if>
    </where>
  </select>
</mapper>